# DateUtils クラス仕様書

## 概要

DateUtils クラスは日付に関する様々な操作を提供する静的メソッドのコレクションです。日付のフォーマット、計算、判定機能を含みます。

## メソッド仕様

### formatDate(date: Date, format: string): string

**機能**: 日付を指定されたフォーマットで文字列に変換する

**入力パラメータ**:

- `date`: Date - フォーマットする日付オブジェクト
- `format`: string - フォーマット文字列

**戻り値**:

- string - フォーマットされた日付文字列

**制約条件**:

- dateは有効なDateオブジェクトである必要がある
- formatに含まれるプレースホルダー: YYYY（年）, MM（月）, DD（日）

**例外処理**:

- なし

**フォーマット規則**:

- YYYY: 4桁の年（例: 2023）
- MM: 2桁の月（例: 01-12）
- DD: 2桁の日（例: 01-31）

---

### addDays(date: Date, days: number): Date

**機能**: 指定された日付に日数を加算した新しい日付を返す

**入力パラメータ**:

- `date`: Date - 基準となる日付
- `days`: number - 加算する日数（負数で減算）

**戻り値**:

- Date - 計算結果の新しい日付オブジェクト

**制約条件**:

- daysは整数である必要がある
- 元のdateオブジェクトは変更されない

**例外処理**:

- なし

**動作**:

- 月をまたぐ計算も正しく処理される
- 負数の場合は日数を減算

---

### daysBetween(date1: Date, date2: Date): number

**機能**: 2つの日付間の日数差を計算する

**入力パラメータ**:

- `date1`: Date - 第1の日付
- `date2`: Date - 第2の日付

**戻り値**:

- number - 日数差（絶対値、小数点以下切り上げ）

**制約条件**:

- 両方とも有効なDateオブジェクトである必要がある
- 結果は常に正の数

**例外処理**:

- なし

**計算方法**:

- 絶対値を取るため、日付の順序は関係ない
- 時間差も考慮し、1日未満の差は1日に切り上げ

---

### isWeekend(date: Date): boolean

**機能**: 指定された日付が週末（土曜日または日曜日）かどうかを判定する

**入力パラメータ**:

- `date`: Date - 判定する日付

**戻り値**:

- boolean - 週末の場合true、平日の場合false

**制約条件**:

- 有効なDateオブジェクトである必要がある

**例外処理**:

- なし

**判定基準**:

- 日曜日（getDay() === 0）または土曜日（getDay() === 6）

---

### getQuarter(date: Date): number

**機能**: 指定された日付の四半期を取得する

**入力パラメータ**:

- `date`: Date - 判定する日付

**戻り値**:

- number - 四半期（1, 2, 3, 4）

**制約条件**:

- 有効なDateオブジェクトである必要がある

**例外処理**:

- なし

**四半期定義**:

- Q1: 1-3月
- Q2: 4-6月
- Q3: 7-9月
- Q4: 10-12月

---

### isLeapYear(year: number): boolean

**機能**: 指定された年がうるう年かどうかを判定する

**入力パラメータ**:

- `year`: number - 判定する年（正の整数）

**戻り値**:

- boolean - うるう年の場合true、平年の場合false

**制約条件**:

- yearは1以上の正の整数である必要がある

**例外処理**:

- `year < 1` の場合: `Error("Year must be positive")` をスロー

**判定ルール**:

- 4で割り切れる年はうるう年
- ただし、100で割り切れる年は平年
- ただし、400で割り切れる年はうるう年

---

### getAge(birthDate: Date, currentDate: Date = new Date()): number

**機能**: 誕生日から現在の年齢を計算する

**入力パラメータ**:

- `birthDate`: Date - 誕生日
- `currentDate`: Date - 基準日（デフォルト: 現在日時）

**戻り値**:

- number - 年齢（歳）

**制約条件**:

- birthDateはcurrentDateより過去である必要がある
- 両方とも有効なDateオブジェクトである必要がある

**例外処理**:

- `birthDate > currentDate` の場合: `Error("Birth date cannot be in the future")` をスロー

**計算方法**:

- 年の差を基本とし、まだ誕生日を迎えていない場合は1歳減算

## テスト観点

### 同値分割法

- **正常値**:
  - 有効な日付範囲
  - 有効な年（1以上）
  - 有効なフォーマット文字列
- **異常値**:
  - 無効な日付
  - 負の年
  - 未来の誕生日

### 境界値分析

- **年境界**:
  - うるう年判定（4の倍数、100の倍数、400の倍数）
  - 最小年（1）
- **月境界**:
  - 月末日付の加算
  - 四半期の境界月（3,6,9,12月）
- **曜日境界**:
  - 週末の境界（金曜日、土曜日、日曜日、月曜日）

### エラーケース

- **無効年エラー**: isLeapYear
- **未来日付エラー**: getAge
- **無効日付**: すべてのメソッド

### 特殊ケース

- **時差**: 異なるタイムゾーン
- **夏時間**: 時間変更の影響
- **月末**: 2月28日/29日、月の日数差
- **年またぎ**: 12月から1月への変更
